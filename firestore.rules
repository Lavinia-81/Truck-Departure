/**
 * @fileoverview Firestore Security Rules for the dispatch schedule application.
 *
 * Core Philosophy:
 * This ruleset provides public read access to dispatch schedules while restricting write access
 * to authenticated users only. This allows anyone to view the schedules, but only logged-in users
 * can create, modify, or delete them.
 *
 * Data Structure:
 * - /dispatchSchedules/{dispatchScheduleId}:  Stores individual dispatch schedule documents.
 *
 * Key Security Decisions:
 * - Public Read Access: Dispatch schedules are readable by everyone.
 * - Authenticated Write Access: Only authenticated users can create, update, or delete schedules.
 * - No User Roles:  There are no admin or privileged roles in this initial ruleset.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to dispatch schedules, but restricts writes to authenticated users.
     * @path /dispatchSchedules/{dispatchScheduleId}
     * @allow (get, list): Any user can read dispatch schedules.
     * @allow (create, update, delete): Only authenticated users can modify dispatch schedules.
     * @deny (create, update, delete): Non-authenticated users cannot modify dispatch schedules.
     * @principle Allows public visibility of dispatch schedules while ensuring that only authenticated users can modify them.
     */
    match /dispatchSchedules/{dispatchScheduleId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    // --- Helper Functions ---
    function isSignedIn() {
      return request.auth != null;
    }
  }
}